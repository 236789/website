<!DOCTYPE html>
<html lang="ro">
<head>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-B6DWPJ4T2C"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-B6DWPJ4T2C');
  </script>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Galerie Portrete â€” KSDAPromovari</title>
  <link rel="icon" type="image/png" href="https://iili.io/fXks1Dv.png">

  <!-- Fonts & Icons -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600;700;800;900&family=Poppins:wght@300;400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    /* --- VARIABLES & THEME --- */
    :root {
      --bg-dark: #050b14;
      --primary: #29f3ff;
      --primary-dim: rgba(41, 243, 255, 0.15);
      --glass-bg: rgba(13, 25, 41, 0.85);
      --glass-border: rgba(255, 255, 255, 0.08);
      --text-main: #ffffff;
      --text-muted: #a5b1c2;
      --star-color: #ffcc00;
      --bar-bg: rgba(255, 255, 255, 0.1);
      --card-radius: 24px;
      --transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }

    * { box-sizing: border-box; outline: none; }
    html { scroll-behavior: smooth; }

    body {
      margin: 0; min-height: 100vh;
      background-color: var(--bg-dark);
      background-image: linear-gradient(to bottom, rgba(5, 11, 20, 0.85), var(--bg-dark)), url('https://i.makeagif.com/media/3-03-2021/otrneG.gif');
      background-position: center; background-size: cover; background-attachment: fixed;
      font-family: 'Poppins', sans-serif; color: var(--text-main);
      display: flex; flex-direction: column; overflow-x: hidden;
    }

    ::-webkit-scrollbar { width: 8px; }
    ::-webkit-scrollbar-track { background: var(--bg-dark); }
    ::-webkit-scrollbar-thumb { background: #1f3a52; border-radius: 4px; }
    ::-webkit-scrollbar-thumb:hover { background: var(--primary); }

    h1, h2, h3, .logo, .btn, .bubbleBtn, #sideMenu a, .login-btn-header, .side-menu-login-btn, .pop-user, .streak-txt, .coins-count { 
        font-family: 'Orbitron', sans-serif; 
    }

    /* --- ACCOUNT POPUP MODAL STYLES --- */
    .account-modal-overlay {
        position: fixed; inset: 0; background: rgba(0,0,0,0.85);
        display: none; justify-content: center; align-items: center;
        z-index: 11000; backdrop-filter: blur(10px);
    }
    .account-modal-overlay.active { display: flex; }

    .account-card {
        background: #08101b; border: 1px solid var(--primary);
        width: 90%; max-width: 380px; border-radius: 30px;
        padding: 40px 25px; text-align: center; position: relative;
        box-shadow: 0 0 50px rgba(41, 243, 255, 0.3);
        animation: jumpIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
    }

    @keyframes jumpIn {
        0% { transform: scale(0.3) translateY(100px); opacity: 0; }
        100% { transform: scale(1) translateY(0); opacity: 1; }
    }

    .close-pop { position: absolute; top: 15px; right: 20px; color: #fff; cursor: pointer; font-size: 24px; background: none; border: none; opacity: 0.5; transition: 0.3s; }
    .pop-img { width: 90px; height: 90px; border-radius: 50%; border: 2px solid var(--primary); margin-bottom: 12px; box-shadow: 0 0 20px var(--primary-dim); }
    .pop-user { font-size: 18px; color: #fff; margin: 0; letter-spacing: 1px; }
    .pop-mail { font-size: 12px; color: var(--text-muted); margin-bottom: 20px; }

    .streak-box {
        display: inline-flex; align-items: center; gap: 8px;
        background: rgba(255, 69, 0, 0.1); border-radius: 50px;
        padding: 6px 16px; margin-bottom: 15px; border: 1px solid rgba(255, 69, 0, 0.2);
    }
    .streak-box i { color: #ff4500; font-size: 18px; animation: fireBurn 1.5s infinite; }
    @keyframes fireBurn { 0%, 100% { filter: brightness(1); } 50% { filter: brightness(1.5) drop-shadow(0 0 5px #ff4500); } }
    .streak-txt { font-weight: 800; color: #ff4500; font-size: 13px; }

    .coins-section {
        display: flex; flex-direction: column; align-items: center; gap: 5px;
        margin-bottom: 25px; background: rgba(255, 255, 255, 0.03);
        padding: 12px; border-radius: 20px; border: 1px solid var(--glass-border);
    }
    .coins-label { font-family: 'Orbitron'; font-size: 10px; color: var(--primary); text-transform: uppercase; }
    .coins-display { display: flex; align-items: center; gap: 10px; }
    .coins-icon-img { width: 30px; height: 30px; object-fit: contain; }
    .coins-count { font-size: 20px; font-weight: 900; color: #fff; }

    .btn-tasks {
        background: rgba(41, 243, 255, 0.05); border: 1px solid var(--primary); color: var(--primary);
        padding: 16px; border-radius: 18px; text-decoration: none; display: flex;
        flex-direction: column; align-items: center; gap: 5px; transition: 0.3s; margin-bottom: 15px;
    }
    .btn-tasks:hover { background: var(--primary); color: #000; box-shadow: 0 0 20px var(--primary-dim); transform: translateY(-2px); }

    .btn-logout-pop {
        background: transparent; border: 1.5px solid #ff4757; color: #ff4757;
        padding: 10px 25px; border-radius: 12px; font-family: 'Orbitron'; font-weight: 700;
        cursor: pointer; transition: 0.3s; font-size: 12px; text-transform: uppercase;
    }
    .btn-logout-pop:hover { background: #ff4757; color: #fff; box-shadow: 0 0 15px rgba(255, 71, 87, 0.4); }

    /* --- SPECIAL THANK YOU POPUP (HIDDEN FOR FUTURE) --- */
    .reward-modal {
        position: fixed; inset: 0; background: rgba(0,0,0,0.9);
        display: none; justify-content: center; align-items: center;
        z-index: 12000; padding: 20px;
    }
    .reward-card {
        background: #08101b; border: 2px solid #ffd700; border-radius: 30px;
        padding: 40px; text-align: center; max-width: 400px; width: 100%;
    }

    /* --- HEADER --- */
    .header-container { position: fixed; top: 0; left: 0; right: 0; padding: 20px; z-index: 1000; display: flex; justify-content: center; }
    header { width: 100%; max-width: 1200px; display: flex; align-items: center; justify-content: space-between; padding: 12px 30px; background: rgba(5, 11, 20, 0.6); border: 1px solid var(--glass-border); border-radius: 100px; backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px); box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
    .logo { font-weight: 900; font-size: 24px; letter-spacing: 1px; background: linear-gradient(90deg, #fff, var(--primary)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; text-transform: uppercase; text-decoration: none; }
    .logo img { height: 40px; vertical-align: middle; transition: 0.3s; }

    nav { display: flex; gap: 32px; align-items: center; }
    nav a { color: var(--text-muted); text-decoration: none; font-size: 13px; font-weight: 600; transition: 0.3s; position: relative; }
    nav a:hover { color: var(--primary); }
    
    .login-btn-header { background: transparent; border: 1.5px solid var(--primary); color: var(--primary); padding: 8px 20px; border-radius: 20px; font-size: 12px; font-weight: 700; cursor: pointer; text-transform: uppercase; transition: 0.3s; display: flex; align-items: center; gap: 8px; }
    .login-btn-header:hover { background: var(--primary); color: #000; box-shadow: 0 0 15px rgba(41, 243, 255, 0.4); }
    .user-avatar-small { width: 24px; height: 24px; border-radius: 50%; border: 1px solid #fff; display: none; }

    .hamburger { display: none; background: none; border: none; color: #fff; font-size: 26px; cursor: pointer; }

    /* --- SIDE MENU (FIXED TO MATCH IMAGE) --- */
    #sideMenu { 
        position: fixed; inset: 0; left: auto; width: 320px; 
        background: #050b14; 
        border-left: 1px solid var(--glass-border); 
        z-index: 2000; padding: 40px 30px; 
        transform: translateX(100%); 
        transition: transform 0.4s cubic-bezier(0.77, 0, 0.175, 1); 
        display: flex; flex-direction: column; 
    }
    #sideMenu.open { transform: translateX(0); }
    .menu-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
    .menu-logo img { height: 50px; }
    .closeBtn { font-size: 42px; background: none; border: none; color: #fff; cursor: pointer; }
    
    .menu-divider { width: 100%; height: 1px; background: rgba(255,255,255,0.1); margin-bottom: 40px; }

    .menu-links { display: flex; flex-direction: column; gap: 35px; }
    .menu-links a { color: #fff; text-decoration: none; font-size: 28px; font-weight: 600; transition: 0.3s; }
    .menu-links a:hover { color: var(--primary); }

    .side-menu-login-btn { 
        background: rgba(41, 243, 255, 0.05); 
        border: 1.5px solid var(--primary); 
        color: var(--primary); 
        width: 100%; padding: 16px; 
        margin-top: auto; 
        border-radius: 20px; 
        font-size: 18px; font-weight: 700; 
        cursor: pointer; transition: 0.3s; 
        text-transform: uppercase; 
        display: flex; justify-content: center; align-items: center; gap: 12px; 
    }
    .side-menu-login-btn:hover { background: var(--primary); color: #000; box-shadow: 0 0 20px var(--primary-dim); }

    /* --- GALLERY GRID (PC: 5, MOBILE: 1) --- */
    .container { width:100%; max-width:1400px; margin-top: 140px; display: flex; flex-direction: column; align-items: center; padding: 0 16px; }
    .hero-title { font-size: clamp(28px, 5vw, 48px); margin-bottom: 20px; text-transform: uppercase; font-family: 'Orbitron'; font-weight: 900; background: linear-gradient(180deg, #ffffff 0%, #a2cfff 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    .hero-description { max-width: 800px; text-align: center; color: var(--text-muted); font-size: 16px; line-height: 1.6; margin-bottom: 50px; }

    .gallery-grid {
      display: grid;
      grid-template-columns: repeat(5, 1fr); 
      gap: 25px; width: 100%; margin-bottom: 60px;
    }

    @media (max-width: 1024px) { .gallery-grid { grid-template-columns: repeat(2, 1fr); } }
    @media (max-width: 768px) { nav { display: none; } .hamburger { display: block; } .gallery-grid { grid-template-columns: 1fr; } }

    .gallery-item {
        background: var(--glass-bg); border: 1px solid var(--glass-border);
        border-radius: 20px; overflow: hidden; transition: 0.3s;
        display: flex; flex-direction: column;
    }
    .gallery-item:hover { border-color: var(--primary); transform: translateY(-5px); }
    .gallery-img { width: 100%; height: 300px; object-fit: cover; cursor: pointer; transition: 0.3s; border-bottom: 1px solid var(--glass-border); }
    .gallery-img:hover { filter: brightness(1.2); }

    /* INTERACTION BUTTONS */
    .img-footer { padding: 15px; display: flex; flex-direction: column; gap: 10px; }
    .actions-row { display: flex; justify-content: space-between; align-items: center; }
    .votes { display: flex; gap: 8px; }
    .vote-btn { background: rgba(255,255,255,0.05); border: 1px solid var(--glass-border); color: var(--text-muted); padding: 8px 12px; border-radius: 10px; cursor: pointer; font-size: 12px; transition: 0.2s; display: flex; align-items: center; gap: 6px; }
    .vote-btn:hover { background: rgba(41, 243, 255, 0.1); color: var(--primary); }
    .vote-btn.active-like { color: var(--primary); border-color: var(--primary); }
    .vote-btn.active-dislike { color: #ff4757; border-color: #ff4757; }

    .comment-sec { display: none; border-top: 1px solid var(--glass-border); padding-top: 10px; }
    .comment-list { max-height: 120px; overflow-y: auto; display: flex; flex-direction: column; gap: 8px; margin-bottom: 10px; }
    .com-box { display: flex; gap: 8px; font-size: 11px; }
    .com-box img { width: 22px; height: 22px; border-radius: 50%; }
    .com-text-wrap { background: rgba(255,255,255,0.03); padding: 6px 10px; border-radius: 10px; flex: 1; }
    .com-user-name { font-weight: 700; color: var(--primary); margin-right: 5px; }

    .com-input-wrap { display: flex; gap: 6px; }
    .com-input-wrap input { flex: 1; background: rgba(255,255,255,0.05); border: 1px solid var(--glass-border); border-radius: 10px; padding: 6px 12px; font-size: 12px; color: #fff; }
    .com-send { background: var(--primary); border: none; border-radius: 10px; padding: 0 12px; cursor: pointer; color: #000; }

    /* LIGHTBOX */
    .lightbox { display: none; position: fixed; z-index: 3000; inset: 0; background: rgba(0, 0, 0, 0.92); backdrop-filter: blur(5px); justify-content: center; align-items: center; }
    .lb-content { max-width: 90%; max-height: 85vh; border-radius: 8px; border: 1px solid var(--primary); animation: zoomIn 0.3s; }
    @keyframes zoomIn { from {transform:scale(0.8); opacity:0;} to {transform:scale(1); opacity:1;} }
    .close-lb { position: absolute; top: 20px; right: 30px; color: #fff; font-size: 40px; cursor: pointer; }

    /* FOOTER */
    footer { width: 100%; background: #02050a; border-top: 1px solid var(--glass-border); padding: 60px 20px 30px; text-align: center; margin-top: auto; }
    .footer-links { display: flex; justify-content: center; gap: 30px; margin: 30px 0; flex-wrap: wrap; }
    .footer-links a { color: var(--text-muted); text-decoration: none; font-size: 14px; transition: 0.2s; font-weight: 500; }
    .footer-links a:hover { color: var(--primary); }
    .made-by-wrapper { margin-top: 30px; display: flex; flex-direction: column; align-items: center; gap: 15px; }
    .footer-pfp-img { width: 80px; height: 80px; border-radius: 50%; border: 2px solid var(--primary); }
  </style>
</head>
<body>

<!-- REWARD MODAL (HIDDEN) -->
<div id="rewardModal" class="reward-modal">
    <div class="reward-card">
        <h2 style="font-family:'Orbitron'; color:#ffd700;">ðŸŽ‰ TASK COMPLETAT!</h2>
        <p>Apreciem suportul tÄƒu Ã®n galerie.</p>
        <button class="btn" style="background:var(--primary); color:#000; padding:10px 20px; border-radius:10px; font-family:'Orbitron'; cursor:pointer; border:none;" onclick="this.parentElement.parentElement.classList.remove('active')">Super!</button>
    </div>
</div>

<!-- ACCOUNT MODAL -->
<div id="accountModal" class="account-modal-overlay">
    <div class="account-card">
        <button id="closeAccountPop" class="close-pop">âœ•</button>
        <img id="popUserImg" src="" class="pop-img">
        <h3 id="popUserName" class="pop-user">Utilizator</h3>
        <p id="popUserEmail" class="pop-mail">email@exemplu.com</p>
        <div class="streak-box">
            <i class="fas fa-fire"></i>
            <span class="streak-txt">Daily Streak: 0</span>
        </div>
        <div class="coins-section">
            <span class="coins-label">Puncte KSDA</span>
            <div class="coins-display">
                <img src="https://iili.io/fhc1SKQ.png" class="coins-icon-img" alt="Coins">
                <span id="popUserCoins" class="coins-count">0</span>
            </div>
        </div>
        <div class="pop-btns">
            <a href="DailyTasks.html" class="btn-tasks">
                <span class="tasks-title"><i class="fas fa-tasks"></i> Daily Tasks</span>
                <span class="tasks-desc">CompleteazÄƒ task-uri È™i cÃ¢È™tigÄƒ puncte</span>
            </a>
            <button id="popLogoutBtn" class="btn-logout-pop">Log Out</button>
        </div>
    </div>
</div>

<div id="siteContent">
  <!-- HEADER -->
  <div class="header-container">
    <header>
      <a href="index.html" class="logo"><img src="https://iili.io/fXvBEiB.png" alt="Logo" style="height: 40px;"></a>
      <nav>
        <a href="index.html">AcasÄƒ</a>
        <a href="index.html#services">Servicii</a>
        <a href="Wall.html">Wall</a>
        <a href="galerie.html" style="color: var(--primary);">Galerie</a>
        <button id="headerLoginBtn" class="login-btn-header">
            <img id="headerUserImg" src="" class="user-avatar-small">
            <span id="headerLoginText">LOGIN</span>
        </button>
      </nav>
      <button id="menuBtn" class="hamburger">â˜°</button>
    </header>
  </div>

  <!-- SIDE MENU (FIXED) -->
  <aside id="sideMenu">
    <div class="menu-header">
        <div class="logo menu-logo"><img src="https://iili.io/fXvBEiB.png" alt="Logo"></div>
        <button id="closeMenu" class="closeBtn">âœ•</button>
    </div>
    <div class="menu-divider"></div>
    <div class="menu-links">
      <a href="index.html">AcasÄƒ</a>
      <a href="index.html#services">Servicii</a>
      <a href="despre_noi.html">Despre Noi</a>
      <a href="doneaza.html">SusÈ›ine-ne</a>
    </div>
    <button id="mobileLoginBtn" class="side-menu-login-btn">
        <i class="fas fa-sign-in-alt"></i> Autentificare
    </button>
  </aside>

  <main class="container">
    <h1 class="hero-title">Galerie Portrete</h1>
    <p class="hero-description">IatÄƒ o parte din lucrÄƒrile noastre realizate pentru clienÈ›i KSDA.</p>

    <!-- GALLERY GRID (OVER 130 IMAGES MANUALLY LISTED) -->
    <div class="gallery-grid" id="mainGallery">
        <!-- JS va injecta toate imaginile aici cu IDs pentru Firebase -->
    </div>

    <div class="contact-container" style="margin-top: 40px;">
        <a href="https://wa.link/p32m70" target="_blank" class="bubbleBtn">ContacteazÄƒ-ne</a>
    </div>

    <div class="section-divider"></div>
    <h2 class="hero-title" style="font-size: 24px; margin-bottom: 30px;">Ce Oferim</h2>
    <div class="features-grid">
      <div class="feature-card">
        <img src="https://iili.io/f0l7wml.md.png" class="feature-img-small">
        <h3>Comunitate UnitÄƒ</h3>
        <a href="comunitate.html" class="bubbleBtn" style="padding: 10px 20px; font-size: 11px;">AflÄƒ Mai Multe</a>
      </div>
      <div class="feature-card">
        <img src="https://iili.io/f0lYO8J.md.png" class="feature-img-small">
        <h3>ArtÄƒ PersonalizatÄƒ</h3>
        <a href="kevin.html" class="bubbleBtn" style="padding: 10px 20px; font-size: 11px;">Vezi Detalii</a>
      </div>
      <div class="feature-card">
        <img src="https://iili.io/f0lk194.md.png" class="feature-img-small">
        <h3>Entertainment Live</h3>
        <a href="social.html" class="bubbleBtn" style="padding: 10px 20px; font-size: 11px;">IntrÄƒ Ã®n Live</a>
      </div>
    </div>
  </main>

  <footer>
    <div class="footer-content">
      <a href="index.html" class="logo" style="font-size: 28px; display: block; margin-bottom: 20px;">KSDA</a>
      <div class="footer-links"><a href="index.html">AcasÄƒ</a><a href="index.html#services">Servicii</a><a href="contact.html">Contact</a><a href="doneaza.html">SusÈ›ine-ne</a></div>
      <div class="made-by-wrapper">
        <p style="color: var(--text-muted); font-size: 15px;">Website made by Lost Soul</p>
        <img src="https://iili.io/f1ddIfe.png" class="footer-pfp-img">
      </div>
      <p style="color: #445; font-size: 11px; margin-top: 40px;">&copy; 2024 KSDAPromovari</p>
    </div>
  </footer>
</div>

<div id="lightbox" class="lightbox">
    <span class="close-lb" onclick="document.getElementById('lightbox').style.display='none'">âœ•</span>
    <img id="lbImg" class="lb-content" src="">
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
    import { getAuth, signInWithPopup, GoogleAuthProvider, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
    import { getFirestore, doc, getDoc, setDoc, updateDoc, collection, query, orderBy, onSnapshot, serverTimestamp, increment } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDoH80kffNrzFAcyRqsTVdifs-whUhwH9A",
      authDomain: "ksda-7546f.firebaseapp.com",
      projectId: "ksda-7546f",
      storageBucket: "ksda-7546f.firebasestorage.app",
      messagingSenderId: "306437513808",
      appId: "1:306437513808:web:28479810e3fdf71b32e755"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);
    const provider = new GoogleAuthProvider();

    const galleryData = [
        "https://iili.io/f0GxswB.md.jpg", "https://iili.io/f0GxLZP.md.jpg", "https://iili.io/f0GxtMF.md.jpg", "https://iili.io/f0GxZn1.md.jpg", "https://iili.io/f0GxD6g.md.jpg", "https://iili.io/f0GxmFa.md.jpg", "https://iili.io/f0GxpcJ.md.jpg", "https://iili.io/f0Gxy8v.md.jpg", "https://iili.io/f0GzH9R.md.jpg", "https://iili.io/f0GzJup.md.jpg", "https://iili.io/f0GzdwN.md.jpg", "https://iili.io/f0Gz2tI.md.jpg", "https://iili.io/f0GzFnt.md.jpg", "https://iili.io/f0GzKMX.md.jpg", "https://iili.io/f0GzBFs.md.jpg", "https://iili.io/f0GzCcG.md.jpg", "https://iili.io/f0Gzx94.md.jpg", "https://iili.io/f0GzzAl.md.jpg", "https://iili.io/f0GzIN2.md.jpg", "https://iili.io/f0GzTtS.md.jpg", "https://iili.io/f1UOktS.jpg", "https://iili.io/f1UOSV9.jpg", "https://iili.io/f1UOOAl.jpg", "https://iili.io/f1UOhcG.jpg", "https://iili.io/f1UO4cb.jpg", "https://iili.io/f1UOiHx.jpg",
        "https://iili.io/fhP29Tv.md.jpg", "https://iili.io/fhPdpyJ.md.jpg", "https://iili.io/fhPdmva.md.jpg", "https://iili.io/fhPdbYg.md.jpg", "https://iili.io/fhP2HjR.md.jpg", "https://iili.io/fhP2JQp.md.jpg", "https://iili.io/fhP22CN.md.jpg", "https://iili.io/fhP2F4t.md.jpg", "https://iili.io/fhP2f3X.md.jpg", "https://iili.io/fhP2qan.md.jpg", "https://iili.io/fhP2Bvs.md.jpg", "https://iili.io/fhP2CyG.md.jpg", "https://iili.io/fhP2xj4.md.jpg", "https://iili.io/fhP2zZl.md.jpg", "https://iili.io/fhP2ouf.md.jpg", "https://iili.io/fhP2Tn2.md.jpg", "https://iili.io/fhP2uGS.md.jpg", "https://iili.io/fhP2A67.md.jpg", "https://iili.io/fhP25F9.md.jpg", "https://iili.io/fhP27ae.md.jpg", "https://iili.io/fhP2Y8u.md.jpg", "https://iili.io/fhP2luj.md.jpg", "https://iili.io/fhP20wx.md.jpg", "https://iili.io/fhP2GnV.md.jpg", "https://iili.io/fhP2MMB.md.jpg", "https://iili.io/fhP2V6P.md.jpg", "https://iili.io/fhP2XF1.md.jpg", "https://iili.io/fhP2hcF.md.jpg", "https://iili.io/fhP2N9a.md.jpg", "https://iili.io/fhP2OAJ.md.jpg", "https://iili.io/fhP2ewv.md.jpg", "https://iili.io/fhP2ktR.md.jpg", "https://iili.io/fhP2SMN.md.jpg", "https://iili.io/fhP2UPI.md.jpg", "https://iili.io/fhP24cX.md.jpg", "https://iili.io/fhP26Sn.md.jpg", "https://iili.io/fhP2i9s.md.jpg", "https://iili.io/fhP2LNf.md.jpg", "https://iili.io/fhP2sAG.jpg", "https://iili.io/fhP2Qt4.md.jpg", "https://iili.io/fhP2tol.md.jpg", "https://iili.io/fhP2DV2.md.jpg", "https://iili.io/fhP2bPS.md.jpg", "https://iili.io/fhP2pK7.md.jpg", "https://iili.io/fhP2yl9.md.jpg", "https://iili.io/fhP39Se.md.jpg", "https://iili.io/fhP3JHu.jpg", "https://iili.io/fhP3dAb.jpg", "https://iili.io/fhP32Nj.jpg", "https://iili.io/fhP33Dx.jpg", "https://iili.io/fhP3KoQ.jpg", "https://iili.io/fhP3fVV.jpg", "https://iili.io/fhP3qiB.jpg", "https://iili.io/fhP3CKP.jpg", "https://iili.io/fhP3nl1.jpg", "https://iili.io/fhP3oUF.jpg", "https://iili.io/fhP3zHg.jpg", "https://iili.io/fhP3IRa.jpg", "https://iili.io/fhP3TOJ.jpg", "https://iili.io/fhP3uDv.jpg", "https://iili.io/fhP3RxR.jpg", "https://iili.io/fhP35Vp.jpg", "https://iili.io/fhP37iN.jpg", "https://iili.io/fhP3afI.jpg", "https://iili.io/fhP3clt.jpg", "https://iili.io/fhP3lUX.jpg", "https://iili.io/fhP31Jn.jpg", "https://iili.io/fhP3ERs.jpg", "https://iili.io/fhP3GOG.jpg", "https://iili.io/fhP3Mbf.jpg", "https://iili.io/fhP3Wx4.jpg", "https://iili.io/fhP3XWl.jpg", "https://iili.io/fhP3hs2.jpg", "https://iili.io/fhP3wfS.jpg", "https://iili.io/fhP3kJe.jpg", "https://iili.io/fhP3v5u.jpg", "https://iili.io/fhP38Ob.jpg", "https://iili.io/fhP3Sbj.jpg", "https://iili.io/fhP3rWQ.jpg", "https://iili.io/fhP34sV.jpg", "https://iili.io/fhP3i0P.md.jpg", "https://iili.io/fhP3PqB.md.jpg", "https://iili.io/fhP3sg1.md.jpg", "https://iili.io/fhP3QdF.md.jpg", "https://iili.io/fhP3Z5g.md.jpg", "https://iili.io/fhP3tea.md.jpg", "https://iili.io/fhP3DmJ.md.jpg", "https://iili.io/fhP3mzv.md.jpg", "https://iili.io/fhP3pXR.md.jpg", "https://iili.io/fhP3ysp.md.jpg", "https://iili.io/fhPFdgt.md.jpg", "https://iili.io/fhPFKes.md.jpg", "https://iili.io/fhPFBIf.md.jpg", "https://iili.io/fhPFfmG.md.jpg", "https://iili.io/fhPFCX4.md.jpg", "https://iili.io/fhPFxB2.md.jpg", "https://iili.io/fhPFz1S.md.jpg", "https://iili.io/fhPFIr7.md.jpg", "https://iili.io/fhPFu29.md.jpg", "https://iili.io/fhPF5mb.md.jpg", "https://iili.io/fhPFYIj.md.jpg", "https://iili.io/fhPFcLQ.md.jpg", "https://iili.io/fhPF0BV.md.jpg", "https://iili.io/fhPF1EB.md.jpg", "https://iili.io/fhPFErP.jpg", "https://iili.io/fhPFM21.jpg", "https://iili.io/fhPFVYF.jpg", "https://iili.io/fhPFXpa.jpg", "https://iili.io/fhPFjTJ.md.jpg", "https://iili.io/fhPFwhv.md.jpg", "https://iili.io/fhPFNQR.md.jpg", "https://iili.io/fhPFeBp.md.jpg", "https://iili.io/fhPFkEN.md.jpg", "https://iili.io/fhPFv4I.md.jpg", "https://iili.io/fhPFUYX.md.jpg", "https://iili.io/fhPFgvn.md.jpg", "https://iili.io/fhPF6TG.md.jpg", "https://iili.io/fhPFPjf.md.jpg", "https://iili.io/fhPFiQ4.md.jpg", "https://iili.io/fhPFLCl.md.jpg", "https://iili.io/fhPFQG2.md.jpg", "https://iili.io/fhPFZ4S.md.jpg", "https://iili.io/fhPFD37.md.jpg", "https://iili.io/fhPFmve.jpg", "https://iili.io/fhPK9Tb.md.jpg", "https://iili.io/fhPKJZx.md.jpg", "https://iili.io/fhPK2CQ.md.jpg", "https://iili.io/fhPK3GV.md.jpg", "https://iili.io/fhPKF6B.md.jpg", "https://iili.io/fhPKqa1.md.jpg", "https://iili.io/fhPKB8F.md.jpg", "https://iili.io/fhPKCyg.md.jpg", "https://iili.io/fhPKxwJ.md.jpg", "https://iili.io/fhPKzZv.md.jpg", "https://iili.io/fhPKTnR.md.jpg", "https://iili.io/fhPKuGp.md.jpg", "https://iili.io/fhPK7at.md.jpg", "https://iili.io/fhPKY8X.md.jpg"
    ];

    const galleryGrid = document.getElementById('mainGallery');

    function renderGallery() {
        galleryGrid.innerHTML = '';
        galleryData.forEach((src, idx) => {
            const id = `gal_${idx}`;
            const item = document.createElement('div');
            item.className = 'gallery-item';
            item.innerHTML = `
                <img src="${src}" class="gallery-img" onclick="openLightbox('${src}')">
                <div class="img-footer">
                    <div class="actions-row">
                        <div class="votes">
                            <button onclick="voteImg('${id}', 1)" id="like-${id}" class="vote-btn"><i class="fas fa-thumbs-up"></i> <span id="lcnt-${id}">0</span></button>
                            <button onclick="voteImg('${id}', -1)" id="dislike-${id}" class="vote-btn"><i class="fas fa-thumbs-down"></i> <span id="dcnt-${id}">0</span></button>
                        </div>
                        <button onclick="toggleComs('${id}')" class="vote-btn"><i class="fas fa-comment"></i> <span id="ccnt-${id}">0</span></button>
                    </div>
                    <div id="coms-${id}" class="comment-sec">
                        <div id="list-${id}" class="comment-list"></div>
                        <div class="com-input-wrap">
                            <input id="in-${id}" placeholder="Scrie un comentariu...">
                            <button onclick="postCom('${id}')" class="com-send"><i class="fas fa-paper-plane"></i></button>
                        </div>
                    </div>
                </div>
            `;
            galleryGrid.appendChild(item);
            syncInteractions(id);
        });
    }

    window.openLightbox = (src) => { document.getElementById('lbImg').src = src; document.getElementById('lightbox').style.display='flex'; };

    async function syncInteractions(id) {
        onSnapshot(doc(db, "gallery_meta", id), (snap) => {
            if(snap.exists()){
                const d = snap.data();
                const votes = d.votes || {};
                let l=0, di=0;
                Object.values(votes).forEach(v => { if(v===1) l++; if(v===-1) di++; });
                document.getElementById(`lcnt-${id}`).innerText = l;
                document.getElementById(`dcnt-${id}`).innerText = di;
                if(auth.currentUser){
                    const uv = votes[auth.currentUser.uid];
                    document.getElementById(`like-${id}`).classList.toggle('active-like', uv===1);
                    document.getElementById(`dislike-${id}`).classList.toggle('active-dislike', uv===-1);
                }
            }
        });
        onSnapshot(collection(db, `gallery_meta/${id}/comments`), s => document.getElementById(`ccnt-${id}`).innerText = s.size);
    }

    window.voteImg = async (id, type) => {
        if(!auth.currentUser) return alert("LogheazÄƒ-te!");
        const ref = doc(db, "gallery_meta", id);
        const snap = await getDoc(ref);
        let v = snap.exists() ? (snap.data().votes || {}) : {};
        if(v[auth.currentUser.uid] === type) delete v[auth.currentUser.uid];
        else v[auth.currentUser.uid] = type;
        await setDoc(ref, { votes: v }, { merge: true });
    };

    window.toggleComs = (id) => {
        const s = document.getElementById(`coms-${id}`);
        if(s.style.display==='block') s.style.display='none';
        else { s.style.display='block'; loadComs(id); }
    };

    function loadComs(id) {
        const l = document.getElementById('list-' + id);
        onSnapshot(query(collection(db, `gallery_meta/${id}/comments`), orderBy("createdAt", "asc")), (snap) => {
            l.innerHTML = '';
            snap.forEach(d => {
                const c = d.data();
                l.innerHTML += `<div class="com-box"><img src="${c.photo}"><div><span class="com-user-name">${c.name}</span>: ${c.text}</div></div>`;
            });
        });
    }

    window.postCom = async (id) => {
        const i = document.getElementById(`in-${id}`);
        if(!i.value || !auth.currentUser) return;
        await setDoc(doc(collection(db, `gallery_meta/${id}/comments`)), {
            text: i.value, uid: auth.currentUser.uid, name: auth.currentUser.displayName, photo: auth.currentUser.photoURL, createdAt: serverTimestamp()
        });
        i.value = '';
    };

    onAuthStateChanged(auth, async user => {
        if(user){
            document.getElementById('headerLoginText').innerText = "CONT";
            document.getElementById('headerUserImg').src = user.photoURL;
            document.getElementById('headerUserImg').style.display = "block";
            document.getElementById('mobileLoginBtn').innerHTML = '<i class="fas fa-user-circle"></i> CONT';
            onSnapshot(doc(db, "accounts", user.uid), d => {
                if(d.exists()){
                    const data = d.data();
                    document.getElementById('popUserImg').src = data.image;
                    document.getElementById('popUserName').innerText = data.username;
                    document.getElementById('popUserEmail').innerText = data.email;
                    document.getElementById('popUserCoins').innerText = data.coins || 0;
                    document.querySelector('.streak-txt').innerText = `Daily Streak: ${data.streak || 0}`;
                }
            });
        }
        renderGallery();
    });

    document.getElementById('headerLoginBtn').onclick = () => !auth.currentUser ? signInWithPopup(auth, provider) : document.getElementById('accountModal').classList.add('active');
    document.getElementById('mobileLoginBtn').onclick = () => !auth.currentUser ? signInWithPopup(auth, provider) : document.getElementById('accountModal').classList.add('active');
    document.getElementById('closeAccountPop').onclick = () => document.getElementById('accountModal').classList.remove('active');
    document.getElementById('popLogoutBtn').onclick = () => signOut(auth).then(()=>location.reload());

    const menuBtn = document.getElementById("menuBtn");
    const sideMenu = document.getElementById("sideMenu");
    menuBtn.onclick = () => sideMenu.classList.add("open");
    document.getElementById("closeMenu").onclick = () => sideMenu.classList.remove("open");
</script>
</body>
</html>
