<!DOCTYPE html>
<html lang="ro">
<head>

    <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-B6DWPJ4T2C"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-B6DWPJ4T2C');
  </script>

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Misiuni ‚Äî KSDAPromovari</title>
  <meta name="description" content="FinalizeazƒÉ misiuni, c√¢»ôtigƒÉ monede KSDA »ôi deblocheazƒÉ recompense √Æn comunitate.">
<link rel="icon" type="image/png" href="https://iili.io/fXks1Dv.png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600;700;800;900&family=Poppins:wght@300;400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    /* --- VARIABLES & THEME --- */
    :root {
      --bg-dark: #050b14;
      --primary: #29f3ff;
      --primary-dim: rgba(41, 243, 255, 0.15);
      --secondary: #7000ff;
      --text-main: #ffffff;
      --text-muted: #a5b1c2;
      --glass-bg: rgba(13, 25, 41, 0.7);
      --glass-border: rgba(255, 255, 255, 0.08);
      --glow-shadow: 0 0 20px rgba(41, 243, 255, 0.3);
      --card-radius: 24px;
      --transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      --discord-color: #5865F2;
    }

    * { box-sizing: border-box; outline: none; }
    html { scroll-behavior: smooth; }

    body {
      margin: 0; min-height: 100vh;
      background-color: var(--bg-dark);
      background-image: linear-gradient(to bottom, rgba(5, 11, 20, 0.85), var(--bg-dark)), url('https://i.makeagif.com/media/3-03-2021/otrneG.gif');
      background-position: center; background-size: cover; background-attachment: fixed;
      font-family: 'Poppins', sans-serif; color: var(--text-main); overflow-x: hidden;
    }

    ::-webkit-scrollbar { width: 8px; }
    ::-webkit-scrollbar-track { background: var(--bg-dark); }
    ::-webkit-scrollbar-thumb { background: #1f3a52; border-radius: 4px; }
    ::-webkit-scrollbar-thumb:hover { background: var(--primary); }

    h1, h2, h3, .logo, .stat-number, .btn, .bubbleBtn, #sideMenu a, .metallic-title-big, .login-btn-header, .side-menu-login-btn, .pop-user, .streak-txt, .coins-count { 
        font-family: 'Orbitron', sans-serif; 
    }
    
    /* --- BANNED SCREEN STYLES --- */
    #bannedOverlay {
        display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(10, 0, 0, 0.98); z-index: 10000;
        flex-direction: column; justify-content: center; align-items: center;
        text-align: center; padding: 20px;
    }
    .ban-icon { font-size: 80px; color: #ff4757; margin-bottom: 20px; animation: pulseRed 2s infinite; }
    @keyframes pulseRed { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.1); } }
    .ban-title { font-size: 32px; color: #ff4757; margin-bottom: 10px; }
    .ban-details { background: rgba(255, 0, 0, 0.1); border: 1px solid #ff4757; padding: 30px; border-radius: 20px; max-width: 500px; width: 100%; }

    /* --- COOKIE POPUP STYLES --- */
    .cookie-wrapper {
        position: fixed; bottom: 20px; right: 20px; left: 20px;
        background: rgba(8, 16, 27, 0.95); border: 1px solid var(--primary);
        backdrop-filter: blur(10px); padding: 20px; border-radius: 16px; z-index: 9990;
        display: none; flex-direction: row; align-items: center; justify-content: space-between; gap: 20px;
        box-shadow: 0 0 25px rgba(41, 243, 255, 0.15); max-width: 900px; margin: 0 auto;
    }

    /* --- ACCOUNT POPUP MODAL STYLES --- */
    .account-modal-overlay {
        position: fixed; inset: 0; background: rgba(0,0,0,0.85);
        display: none; justify-content: center; align-items: center;
        z-index: 11000; backdrop-filter: blur(10px);
    }
    .account-modal-overlay.active { display: flex; }
    .account-card {
        background: #08101b; border: 1px solid var(--primary);
        width: 90%; max-width: 380px; border-radius: 30px; padding: 40px 25px;
        text-align: center; position: relative; box-shadow: 0 0 50px rgba(41, 243, 255, 0.3);
        animation: jumpIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
    }
    @keyframes jumpIn { 0% { transform: scale(0.3) translateY(100px); opacity: 0; } 100% { transform: scale(1) translateY(0); opacity: 1; } }
    .close-pop { position: absolute; top: 15px; right: 20px; color: #fff; cursor: pointer; font-size: 24px; background: none; border: none; }
    .pop-img { width: 90px; height: 90px; border-radius: 50%; border: 2px solid var(--primary); margin-bottom: 12px; }

    /* PUNCTE KSDA SECTION */
    .coins-section {
        display: flex; flex-direction: column; align-items: center; gap: 5px;
        margin-bottom: 25px; background: rgba(255, 255, 255, 0.03);
        padding: 12px; border-radius: 20px; border: 1px solid var(--glass-border);
    }
    .coins-icon-img { width: 30px; height: 30px; object-fit: contain; }
    .coins-count { font-size: 20px; font-weight: 900; color: #fff; }

    .btn-tasks {
        background: rgba(41, 243, 255, 0.05); border: 1px solid var(--primary); color: var(--primary);
        padding: 16px; border-radius: 18px; text-decoration: none; display: flex;
        flex-direction: column; align-items: center; gap: 5px; transition: 0.3s; margin-bottom: 15px;
    }

    /* --- QUESTS SPECIFIC STYLES --- */
    .quests-section {
        min-height: 80vh; padding: 160px 20px 80px;
        display: flex; flex-direction: column; align-items: center; text-align: center;
    }
    .quests-container { width: 100%; max-width: 1100px; margin-top: 50px; }
    .quest-card {
        background: var(--glass-bg); border: 1px solid var(--glass-border);
        border-radius: 24px; padding: 30px; margin-bottom: 20px;
        display: flex; justify-content: space-between; align-items: center;
        transition: 0.3s; text-align: left;
    }
    .quest-card:hover { transform: scale(1.02); border-color: var(--primary); box-shadow: 0 10px 30px rgba(41, 243, 255, 0.1); }
    .quest-info h4 { margin: 0; font-family: 'Orbitron'; font-size: 18px; color: var(--primary); }
    .quest-info p { margin: 5px 0 0; font-size: 13px; color: var(--text-muted); }
    .quest-reward { display: flex; align-items: center; gap: 10px; font-family: 'Orbitron'; font-weight: 800; color: #ffd700; }
    .reward-img { width: 24px; height: 24px; }

    /* --- HEADER & SIDE REUSE --- */
    .header-container { position: fixed; top: 0; left: 0; right: 0; padding: 20px; z-index: 1000; display: flex; justify-content: center; }
    header { width: 100%; max-width: 1200px; display: flex; align-items: center; justify-content: space-between; padding: 10px 30px; background: rgba(5, 11, 20, 0.6); border: 1px solid var(--glass-border); border-radius: 100px; backdrop-filter: blur(16px); box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
    .logo { font-weight: 900; font-size: 24px; background: linear-gradient(90deg, #fff, var(--primary)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; text-decoration: none; }
    nav { display: flex; gap: 32px; align-items: center; }
    nav a { color: var(--text-muted); text-decoration: none; font-size: 13px; font-weight: 600; }
    .login-btn-header { background: transparent; border: 1.5px solid var(--primary); color: var(--primary); padding: 8px 20px; border-radius: 20px; font-size: 12px; font-weight: 700; cursor: pointer; display: flex; align-items: center; gap: 8px; }
    .user-avatar-small { width: 24px; height: 24px; border-radius: 50%; display: none; }
    .hamburger { display: none; background: none; border: none; color: #fff; font-size: 26px; cursor: pointer; }
    #sideMenu { position: fixed; inset: 0; left: auto; width: 320px; background: #08101b; border-left: 1px solid var(--glass-border); z-index: 2000; padding: 40px 30px; transform: translateX(100%); transition: 0.4s; display: flex; flex-direction: column; }
    #sideMenu.open { transform: translateX(0); }
    .menu-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; }
    .closeBtn { font-size: 42px; background: none; border: none; color: #fff; cursor: pointer; }
    .menu-links { display: flex; flex-direction: column; gap: 35px; }
    .menu-links a { color: #fff; text-decoration: none; font-size: 24px; font-weight: 600; }
    .side-menu-login-btn { background: rgba(41, 243, 255, 0.1); border: 1px solid var(--primary); color: var(--primary); width: 100%; padding: 15px; margin-top: 20px; border-radius: 12px; font-size: 16px; font-weight: 700; cursor: pointer; display: flex; justify-content: center; align-items: center; gap: 10px; }

    /* --- SECTIONS FROM HOME --- */
    .wall-promo-wrapper { text-align: center; padding: 40px 20px; display: flex; flex-direction: column; align-items: center; margin-bottom: 60px; border-top: 1px solid var(--glass-border); border-bottom: 1px solid var(--glass-border); width: 100%; max-width: 1200px; margin-left: auto; margin-right: auto; }
    .metallic-title-big { font-size: clamp(24px, 4vw, 36px); font-weight: 900; background: linear-gradient(180deg, #ffffff 0%, #a2cfff 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; text-shadow: 0 10px 30px rgba(0,0,0,0.3); margin-bottom: 15px; text-transform: uppercase; }
    .wall-promo-desc { font-size: 16px; color: var(--text-muted); max-width: 700px; margin-bottom: 25px; line-height: 1.6; }
    .stats-wrapper { background: linear-gradient(90deg, transparent, rgba(41, 243, 255, 0.05), transparent); border-top: 1px solid var(--glass-border); border-bottom: 1px solid var(--glass-border); padding: 60px 0; margin-bottom: 40px; }
    .stats-container { display: flex; justify-content: space-around; flex-wrap: wrap; gap: 40px; max-width: 1000px; margin: 0 auto; }
    .stat-number { font-size: 48px; font-weight: 800; color: #fff; display: block; }
    .stat-label { color: var(--primary); font-size: 14px; text-transform: uppercase; }
    .feature-card { background: var(--glass-bg); border: 1px solid var(--glass-border); border-radius: var(--card-radius); padding: 40px 30px; text-align: center; transition: var(--transition); }
    .feature-img { width: 100px; margin-bottom: 20px; }
    .section-title { font-size: 32px; text-align: center; margin-bottom: 60px; position: relative; display: inline-block; left: 50%; transform: translateX(-50%); background: linear-gradient(180deg, #ffffff 0%, #a2cfff 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    .bubbleBtn { padding: 10px 24px; border-radius: 999px; font-weight: 800; background: linear-gradient(90deg, #1df7ff, #59ffd9); color: #05212a; text-decoration: none; margin-top: 20px; display: inline-block; }
    footer { background: #02050a; padding: 60px 20px 30px; text-align: center; border-top: 1px solid var(--glass-border); }

    /* --- REWARD MODAL --- */
    .reward-modal { position: fixed; inset: 0; background: rgba(0,0,0,0.9); display: none; justify-content: center; align-items: center; z-index: 12000; padding: 20px; }
    .reward-modal.active { display: flex; }
    .reward-card { background: #08101b; border: 2px solid #ffd700; border-radius: 30px; padding: 40px; text-align: center; max-width: 400px; width: 100%; animation: jumpIn 0.6s forwards; }

    /* --- BOT STYLES --- */
    .bot-trigger { position: fixed; bottom: 20px; left: 20px; width: 50px; height: 50px; background: #08101b; border: 2px solid #29f3ff; border-radius: 50%; color: #29f3ff; font-size: 22px; display: flex; align-items: center; justify-content: center; cursor: pointer; z-index: 9999; box-shadow: 0 0 15px rgba(41, 243, 255, 0.3); }
    .bot-phone-box { position: fixed; bottom: 85px; left: 20px; width: 230px; height: 360px; background: #08101b; border-radius: 25px; z-index: 9998; display: none; flex-direction: column; overflow: hidden; border: 2px solid #29f3ff; box-shadow: 0 15px 40px rgba(0,0,0,0.8); }
    .bot-phone-box.active { display: flex; animation: botSlide 0.3s ease-out; }
    @keyframes botSlide { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
    .bot-header { background: #111d2d; padding: 12px; display: flex; align-items: center; gap: 10px; border-bottom: 1px solid rgba(255,255,255,0.08); }
    .bot-avatar { width: 32px; height: 32px; border-radius: 50%; border: 1.5px solid #29f3ff; background: url('https://images.squarespace-cdn.com/content/v1/68026d02ef3401024739f55f/345b1fcb-5942-4eb3-831f-b6a42b23051b/21584177-ae66-438a-a2cd-27dc4461a670_removalai_preview.png?format=300w') center/cover; }
    .bot-body { flex: 1; padding: 10px; overflow-y: auto; display: flex; flex-direction: column; gap: 8px; background: #050b14; }
    .bot-msg { max-width: 85%; padding: 8px 12px; border-radius: 12px; font-size: 11px; line-height: 1.4; }
    .bot-msg-bot { align-self: flex-start; background: #1a2635; color: #eee; }
    .bot-msg-user { align-self: flex-end; background: linear-gradient(135deg, #29f3ff, #0082c8); color: #000; font-weight: 600; }
    .bot-footer { padding: 10px; border-top: 1px solid rgba(255,255,255,0.08); }
    .bot-options { display: flex; flex-direction: column; gap: 5px; }
    .bot-opt-btn { background: transparent; border: 1px solid #29f3ff; color: #fff; padding: 6px; border-radius: 8px; font-size: 10px; cursor: pointer; }
    .bot-input-area { display: none; gap: 5px; }
    .bot-input-area input { flex: 1; background: #162436; border: none; border-radius: 15px; height: 28px; padding: 0 10px; color: #fff; font-size: 11px; }

    @media (max-width: 768px) { nav { display: none; } .hamburger { display: block; } }
  </style>
</head>
<body>

<!-- BANNED OVERLAY -->
<div id="bannedOverlay">
    <i class="fas fa-ban ban-icon"></i>
    <h1 class="ban-title">ACCES INTERZIS</h1>
    <div class="ban-details">
        <p style="color:#fff;">IP-ul tƒÉu (<span id="globalBanIp">...</span>) este blocat.</p>
        <span id="globalBanReason">√éncƒÉlcare regulament comunitate</span>
    </div>
</div>

<!-- COOKIE POPUP -->
<div id="cookieConsent" class="cookie-wrapper">
    <div class="cookie-content">
        <div class="cookie-title">üç™ Cookie-uri & GDPR</div>
        <p style="font-size:12px; color:var(--text-muted);">Folosim cookie-uri pentru a-»õi oferi cea mai bunƒÉ experien»õƒÉ.</p>
    </div>
    <button id="acceptCookiesBtn" class="cookie-btn">Sunt de acord</button>
</div>

<!-- REWARD MODAL -->
<div id="rewardModal" class="reward-modal">
    <div class="reward-card">
        <h2 style="font-family:'Orbitron'; color:#ffd700;">üéâ BUN VENIT!</h2>
        <p>Logarea »õi-a adus un bonus de 250 KSDA coins!</p>
        <div class="reward-coins-box">
            <img src="https://iili.io/fhc1SKQ.png" style="width: 50px;">
            <span>250</span>
        </div>
        <button class="bubbleBtn" onclick="document.getElementById('rewardModal').classList.remove('active')">SƒÉ √Æncepem!</button>
    </div>
</div>

<!-- ACCOUNT POP-UP -->
<div id="accountModal" class="account-modal-overlay">
    <div class="account-card">
        <button id="closeAccountPop" class="close-pop">‚úï</button>
        <img id="popUserImg" src="" class="pop-img">
        <h3 id="popUserName" class="pop-user">...</h3>
        <p id="popUserEmail" style="font-size:12px; color:var(--text-muted); margin-bottom:15px;">...</p>
        
        <div class="streak-box">
            <i class="fas fa-fire"></i>
            <span class="streak-txt">Daily Streak: 0</span>
        </div>

        <div class="coins-section">
            <span class="coins-label">Puncte KSDA</span>
            <div class="coins-display">
                <img src="https://iili.io/fhc1SKQ.png" class="coins-icon-img">
                <span id="popUserCoins" class="coins-count">0</span>
            </div>
        </div>

        <a href="DailyTasks.html" class="btn-tasks">
            <span class="tasks-title">Daily Tasks</span>
            <span class="tasks-desc">CompleteazƒÉ task-uri, c√¢»ôtigƒÉ puncte »ôi schimbƒÉ-le pe servicii</span>
        </a>
        <button id="popLogoutBtn" class="btn-logout-pop">Log Out</button>
    </div>
</div>

<div id="siteContent">
    <!-- HEADER -->
    <div class="header-container">
        <header>
            <a href="index.html" class="logo">KSDA</a>
            <nav>
                <a href="index.html">AcasƒÉ</a>
                <a href="index.html#services">Servicii</a>
                <a href="help.html">Sus»õine-ne</a>
                <button id="headerLoginBtn" class="login-btn-header">
                    <img id="headerUserImg" src="" class="user-avatar-small">
                    <span id="headerLoginText">LOGIN</span>
                </button>
            </nav>
            <button id="menuBtn" class="hamburger">‚ò∞</button>
        </header>
    </div>

    <!-- SIDE MENU -->
    <aside id="sideMenu">
        <div class="menu-header"><div class="logo">KSDA</div><button id="closeMenu" class="closeBtn">‚úï</button></div>
        <div class="menu-links">
            <a href="index.html">AcasƒÉ</a>
            <a href="DailyTasks.html" style="color:var(--primary);">Quests</a>
            <a href="help.html">Sus»õine-ne</a>
            <button id="mobileLoginBtn" class="side-menu-login-btn">LOGIN</button>
        </div>
    </aside>

    <!-- NEW QUESTS HERO SECTION -->
    <section class="quests-section">
        <h1 class="metallic-title-big">Daily & Hourly Quests</h1>
        <p class="wall-promo-desc" style="max-width:800px;">Complete quests to earn KSDA coins, then spend those to get rewards, exclusive portraits, and community rank upgrades!</p>
        
        <div class="quests-container">
            <div class="quest-card">
                <div class="quest-info">
                    <h4>Daily Check-in</h4>
                    <p>Visit the site every day to keep your streak alive.</p>
                </div>
                <div class="quest-reward">
                    <img src="https://iili.io/fhc1SKQ.png" class="reward-img"> +50
                </div>
            </div>

            <div class="quest-card">
                <div class="quest-info">
                    <h4>Community Whisperer</h4>
                    <p>Post 5 messages on the Community Wall today.</p>
                </div>
                <div class="quest-reward">
                    <img src="https://iili.io/fhc1SKQ.png" class="reward-img"> +100
                </div>
            </div>

            <div class="quest-card" style="opacity: 0.6;">
                <div class="quest-info">
                    <h4>Hourly Active (Locked)</h4>
                    <p>Stay active for 60 minutes. Resets every hour.</p>
                </div>
                <div class="quest-reward" style="color:#aaa;">
                    <img src="https://iili.io/fhc1SKQ.png" class="reward-img" style="filter:grayscale(1);"> +25
                </div>
            </div>
        </div>
    </section>

    <!-- REUSED HOME SECTIONS -->
    <section class="stats-wrapper">
        <div class="stats-container">
            <div class="stat-item"><span class="stat-number">29+</span><span class="stat-label">Ani Experien»õƒÉ</span></div>
            <div class="stat-item"><span class="stat-number">2000+</span><span class="stat-label">Portrete Livrate</span></div>
            <div class="stat-item"><span class="stat-number">85%</span><span class="stat-label">Satisfac»õie</span></div>
        </div>
    </section>

    <section class="container wall-promo-wrapper">
        <h2 class="metallic-title-big">Community Wall</h2>
        <p class="wall-promo-desc">Ai vreo √Æntrebare? Vrei sƒÉ √Æ»õi dai cu pƒÉrerea despre site?</p>
        <a href="Wall.html" class="btn-outline">Mergi la Wall</a>
    </section>

    <section id="services" class="container">
        <h2 class="section-title">Ce Oferim</h2>
        <div style="display:grid; grid-template-columns:repeat(auto-fit, minmax(300px, 1fr)); gap:30px; margin-bottom:100px;">
            <div class="feature-card">
                <img src="https://iili.io/f0lYO8J.md.png" class="feature-img">
                <h3>ArtƒÉ DigitalƒÉ</h3>
                <p>Portrete profesionale realizate de Kevin Trinity.</p>
                <a href="kevin.html" class="bubbleBtn">Vezi Pre»õuri</a>
            </div>
            <div class="feature-card">
                <img src="https://iili.io/f0l7wml.md.png" class="feature-img">
                <h3>Comunitate</h3>
                <p>Un grup unit de arti»ôti »ôi creatori handmade.</p>
                <a href="comunitate.html" class="bubbleBtn">AlƒÉturƒÉ-te</a>
            </div>
        </div>
    </section>

    <section class="container wall-promo-wrapper">
        <h2 class="metallic-title-big">Recenzii</h2>
        <p class="wall-promo-desc">Vezi ce spun clien»õii despre serviciile noastre.</p>
        <a href="recenzii.html" class="btn-outline">Cite»ôte recenzii</a>
    </section>

    <footer>
        <div class="logo" style="margin-bottom:20px;">KSDA</div>
        <p style="color:var(--text-muted); font-size:13px;">&copy; 2025 KSDAPromovari. Toate drepturile rezervate.</p>
    </footer>
</div>

<!-- BOT UI -->
<div class="bot-trigger" id="botBtn">üí¨</div>
<div class="bot-phone-box" id="botWindow">
    <div class="bot-header">
        <div class="bot-avatar"></div>
        <div style="color:#fff; font-size:11px;"><b>kevin-bot</b></div>
        <button id="botClose" style="background:none; border:none; color:#fff; cursor:pointer; margin-left:auto;">‚úï</button>
    </div>
    <div class="bot-body" id="botHistory"></div>
    <div class="bot-footer">
        <div class="bot-options" id="botOptions">
            <button class="bot-opt-btn" onclick="startBotConversation()">√éncepe conversa»õia</button>
        </div>
        <div class="bot-input-area" id="botInputArea">
            <input type="text" id="botUserInput" placeholder="Scrie ceva...">
            <button id="botSendBtn" style="background:var(--primary); border:none; border-radius:50%; width:28px; height:28px;"><i class="fas fa-paper-plane"></i></button>
        </div>
    </div>
</div>

<!-- SCRIPTS -->
<script>
    const menuBtn = document.getElementById('menuBtn');
    const sideMenu = document.getElementById('sideMenu');
    const closeMenu = document.getElementById('closeMenu');
    menuBtn.onclick = () => sideMenu.classList.add('open');
    closeMenu.onclick = () => sideMenu.classList.remove('open');

    // BOT LOGIC
    const botBtn = document.getElementById('botBtn');
    const botWindow = document.getElementById('botWindow');
    const botClose = document.getElementById('botClose');
    const botHistory = document.getElementById('botHistory');
    const botOptions = document.getElementById('botOptions');
    const botInputArea = document.getElementById('botInputArea');
    const botUserInput = document.getElementById('botUserInput');
    const botSendBtn = document.getElementById('botSendBtn');

    botBtn.onclick = () => botWindow.classList.toggle('active');
    botClose.onclick = () => botWindow.classList.remove('active');

    function addBotMsg(text, sender) {
        const div = document.createElement('div');
        div.className = `bot-msg bot-msg-${sender}`;
        div.innerHTML = text;
        botHistory.appendChild(div);
        botHistory.scrollTop = botHistory.scrollHeight;
    }

    function startBotConversation() {
        addBotMsg("Salut! Sunt online. √éntreabƒÉ-mƒÉ despre portrete, misiuni sau despre Lost Soul. üòé", 'bot');
        botOptions.style.display = 'none';
        botInputArea.style.display = 'flex';
    }

    function processUserMessage(input) {
        const val = input.toLowerCase();
        let resp = "Nu am √Æn»õeles. √éntreabƒÉ-mƒÉ despre portrete sau monede!";
        if(val.includes("portret")) resp = "Narcisa te poate ajuta cu pre»õurile! Contacteaz-o pe WhatsApp.";
        else if(val.includes("monede") || val.includes("coins")) resp = "Po»õi c√¢»ôtiga monede finaliz√¢nd misiunile de pe aceastƒÉ paginƒÉ!";
        else if(val.includes("lost soul")) resp = "Lost Soul (Nica Emmanuel) este creatorul meu »ôi al acestui site.";
        
        setTimeout(() => addBotMsg(resp, 'bot'), 700);
    }

    botSendBtn.onclick = () => {
        const val = botUserInput.value;
        if(!val) return;
        addBotMsg(val, 'user');
        processUserMessage(val);
        botUserInput.value = '';
    }
</script>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
    import { getAuth, signInWithPopup, GoogleAuthProvider, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
    import { getFirestore, doc, getDoc, setDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDoH80kffNrzFAcyRqsTVdifs-whUhwH9A",
      authDomain: "ksda-7546f.firebaseapp.com",
      projectId: "ksda-7546f",
      storageBucket: "ksda-7546f.firebasestorage.app",
      messagingSenderId: "306437513808",
      appId: "1:306437513808:web:28479810e3fdf71b32e755"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);
    const provider = new GoogleAuthProvider();

    const headerLoginBtn = document.getElementById('headerLoginBtn');
    const headerLoginText = document.getElementById('headerLoginText');
    const headerUserImg = document.getElementById('headerUserImg');
    const accountModal = document.getElementById('accountModal');
    const rewardModal = document.getElementById('rewardModal');

    async function getIP() {
        try { const res = await fetch('https://api.ipify.org?format=json'); const data = await res.json(); return data.ip; }
        catch(e) { return "Unknown"; }
    }

    async function handleLogin() {
        try {
            const result = await signInWithPopup(auth, provider);
            const user = result.user;
            const ip = await getIP();
            const userRef = doc(db, "accounts", user.uid);
            const snap = await getDoc(userRef);

            if(!snap.exists()) {
                await setDoc(userRef, { uid: user.uid, username: user.displayName, email: user.email, image: user.photoURL, coins: 250, streak: 0, ip: ip, joinedAt: new Date() });
                rewardModal.classList.add('active');
            } else {
                await setDoc(userRef, { ip: ip, image: user.photoURL }, { merge: true });
            }
        } catch(e) { console.error(e); }
    }

    headerLoginBtn.onclick = () => { if(!auth.currentUser) handleLogin(); else accountModal.classList.add('active'); };
    document.getElementById('mobileLoginBtn').onclick = () => { if(!auth.currentUser) handleLogin(); else accountModal.classList.add('active'); };
    document.getElementById('closeAccountPop').onclick = () => accountModal.classList.remove('active');
    document.getElementById('popLogoutBtn').onclick = () => signOut(auth).then(() => location.reload());

    onAuthStateChanged(auth, user => {
        if (user) {
            headerLoginText.innerText = "ACCOUNT";
            headerUserImg.src = user.photoURL;
            headerUserImg.style.display = "block";
            onSnapshot(doc(db, "accounts", user.uid), (doc) => {
                if(doc.exists()) {
                    const data = doc.data();
                    document.getElementById('popUserImg').src = data.image;
                    document.getElementById('popUserName').innerText = data.username;
                    document.getElementById('popUserEmail').innerText = data.email;
                    document.getElementById('popUserCoins').innerText = data.coins || 0;
                    document.querySelector('.streak-txt').innerText = `Daily Streak: ${data.streak || 0}`;
                }
            });
        }
    });
</script>

</body>
</html>
